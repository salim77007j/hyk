# دليل إعداد Supabase 🗃️

هذا دليل شامل لإعداد قاعدة بيانات Supabase لموقع سينما أونلاين.

## 📋 الخطوات المطلوبة

### 1. إنشاء مشروع Supabase

1. اذهب إلى [Supabase](https://app.supabase.com)
2. قم بإنشاء حساب جديد أو تسجيل الدخول
3. انقر على "New Project"
4. اختر منظمة أو أنشئ واحدة جديدة
5. أدخل تفاصيل المشروع:
   - **اسم المشروع**: Cinema Online
   - **كلمة مرور قاعدة البيانات**: اختر كلمة مرور قوية
   - **المنطقة**: اختر أقرب منطقة لك

### 2. الحصول على مفاتيح API

بعد إنشاء المشروع:

1. اذهب إلى **Settings** > **API**
2. انسخ:
   - **Project URL** (سيبدأ بـ `https://`)
   - **anon/public key** (مفتاح طويل يبدأ عادة بـ `eyJ`)

### 3. إعداد متغيرات البيئة

1. أنشئ ملف `.env.local` في جذر المشروع:

```env
NEXT_PUBLIC_SUPABASE_URL=your-project-url-here
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key-here
```

2. استبدل القيم بالمفاتيح التي حصلت عليها من Supabase

### 4. إنشاء قاعدة البيانات

1. في لوحة تحكم Supabase، اذهب إلى **SQL Editor**
2. انسخ محتويات ملف `supabase/schema.sql` كاملاً
3. الصق المحتوى في SQL Editor
4. انقر على "Run" لتنفيذ الكود

## 🏗️ هيكل قاعدة البيانات

### الجداول الرئيسية:

#### 🎬 Movies
- معلومات الأفلام والمسلسلات
- التقييمات والتصنيفات
- حالة النشر (نشط/غير نشط)

#### 📺 Episodes  
- حلقات المسلسلات
- ربط بالمسلسل الأساسي
- ترقيم الموسم والحلقة

#### 🔗 Streaming Links
- روابط سيرفرات المشاهدة
- دعم DoodStream, UqLoad وغيرها
- جودة الفيديو (HD, 4K, إلخ)

#### 👥 Admins
- حسابات المديرين
- أدوار مختلفة (admin, moderator)

#### 📊 Analytics
- إحصائيات المشاهدة
- التعليقات والمفضلة

### 🔐 الأمان

- **Row Level Security (RLS)** مفعل لجميع الجداول
- سياسات أمان للعرض العام والإدارة
- حماية من SQL Injection

### 📈 الأداء

- فهارس محسنة للبحث السريع
- بحث نصي كامل باللغة العربية
- ضغط وتحسين الصور

## 🧪 اختبار الاتصال

بعد إكمال الإعداد، يمكنك اختبار الاتصال:

1. شغل الموقع: `npm run dev`
2. اذهب إلى الصفحة الرئيسية
3. ستظهر رسالة حالة الاتصال في أعلى الصفحة

## 📝 بيانات المدير الافتراضي

بعد تنفيذ ملف SQL، سيتم إنشاء حساب مدير افتراضي:

- **البريد الإلكتروني**: `admin@cinema.com`
- **كلمة المرور**: `admin123`

> ⚠️ **مهم**: يرجى تغيير كلمة المرور فوراً بعد تسجيل الدخول الأول!

## 🔧 استكشاف الأخطاء

### خطأ في الاتصال:
- تأكد من صحة URL ومفاتيح API
- تحقق من ملف `.env.local`
- تأكد من تنفيذ ملف `schema.sql` بنجاح

### لا توجد بيانات:
- قم بإضافة أفلام من لوحة التحكم
- تحقق من حالة الأفلام (يجب أن تكون 'active')

### مشاكل في الأذونات:
- تأكد من إعدادات RLS في Supabase
- راجع سياسات الأمان في قاعدة البيانات

## 📚 موارد إضافية

- [وثائق Supabase](https://supabase.com/docs)
- [مرجع SQL](https://supabase.com/docs/guides/database)
- [Row Level Security](https://supabase.com/docs/guides/auth/row-level-security)

---

## 🆘 الدعم

إذا واجهت مشاكل في الإعداد:

1. تحقق من console المتصفح للأخطاء
2. راجع هذا الدليل خطوة بخطوة
3. تأكد من صحة جميع المتغيرات البيئية
4. جرب إعادة تشغيل خادم التطوير

---

🎬 **استمتع بموقع سينما أونلاين!** 🎬